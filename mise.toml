[tools]
go = "1.25.4"
node = "24"
prek = "latest"

[hooks]
# Setup git pre-commit hook
postinstall = [
    "git config --unset-all core.hooksPath || true",
    "rm -f .git/hooks/pre-commit*",
    "prek install",
]

[tasks.help]
description = "ðŸ“š Help"
alias = "default"
run = '''# mise tasks --local
    echo " ____  _ _       "
    echo "|  _ \(_) | __ _ "
    echo "| |_) | | |/ _\` |"
    echo "|  __/| | | (_| |"
    echo "|_|   |_|_|\__,_|"
    echo "Stack all the thingsâ„¢"
    echo ""
    mise tasks --local
'''

[tasks.build]
description = "ðŸ› ï¸  Build binary"
run = [
    "go mod tidy",
    '''go build -ldflags '-X go.olrik.dev/pila/internal/core.version={{ exec(command='git describe --tags --match "v[0-9]*.[0-9]*.[0-9]*" 2>/dev/null') }}' -o pila .''',
]

[tasks."lint"]
description = "Lint all markdown files"
raw = true
run = "prek run --all-files markdownlint-cli2"
